<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLI 7 LTE</title>
    <link rel="stylesheet" href="pli.css">
    
    <!-- CRITICAL: Load Google's libraries first in the head -->

</head>
<body>

    <div class="chat-container">
        <header class="chat-header">
            <h2 id="model-title">PLI 7b1 LTE</h2>
            <div class="model-switcher">
                <button id="connect-google-btn" >PLI6</button>
            </div>
        </header>
        <main id="chat-box" class="chat-box"></main>
        <footer class="chat-footer">
            <form id="chat-form" class="chat-form">
                <input type="text" id="user-input" placeholder="Type your message..." autocomplete="off">
                <button type="submit" aria-label="Send Message">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2 .01 7z"/>
                    </svg>
                </button>
            </form>
        </footer>
    </div>

    <!-- CRITICAL: Your script must be a 'module' and load at the end of the body -->
    <script type="module" src="chat.js"></script>
    <script type="module" src="/reminder/googleAuth.js"></script>

    
</body>
<style>

    
</style>
<script>
    const API_KEY = 'AIzaSyCG2Rzn97EvIn3wwnpdOuvyExLEF8vfS9Y';
const CLIENT_ID = '517448730993-pcbekg83r7q763s90algdgt2fcg01ll5.apps.googleusercontent.com';

const DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];
const SCOPES = "https://www.googleapis.com/auth/calendar.events";
    // --- GLOBAL VARIABLES for Google Auth ---
let gapi = null;
let googleAuth = null;
let tokenClient = null; // Use for GIS
function gapiLoaded() {
    gapi = window.gapi;
    gapi.load('client', initializeGapiClient);
}

// This function is now in the global scope
function gisLoaded() {
    tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: (tokenResponse) => {
            // ... handle token response
        },
    });
}

// Function to initialize the GAPI client (can be called from gapiLoaded)
async function initializeGapiClient() {
    await gapi.client.init({
        apiKey: API_KEY,
        discoveryDocs: DISCOVERY_DOCS,
    });
    // Now that the client is initialized, you can update the UI or perform other tasks
}

</script>
</html>