<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLI 7 LTE</title>
    <link rel="stylesheet" href="pli.css">
    <link rel="icon" type="image/x-icon" href="/images/faviconn.ico" >
    
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js?onload=startApp" async defer></script>
</head>
<body>

    <div class="chat-container">
        <header class="chat-header">
            <h2 id="model-title">PLI 7</h2>
            <div class="model-switcher">
                <button id="connect-google-btn">PLI7</button>
            </div>
        </header>
        
        <main id="chat-box" class="chat-box"></main>
        
        <footer class="chat-footer">
            <form id="chat-form" class="chat-form" autocomplete="off">
                <input type="text" id="user-input" placeholder="Type or Hold to Speak..." required>
                
                <!-- CHANGED: Unified Send/Mic Button -->
                <!-- type="button" prevents auto-submit so JS handles tap vs hold -->
                <button type="button" id="send-mic-btn" oncontextmenu="return false;">
                    <span id="btn-icon">
                        <!-- Default SVG Icon (Send Plane) -->
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2 .01 7z"/>
                        </svg>
                    </span>
                </button>
            </form>
        </footer>
    </div>

    <!-- NEW: Audio Live Overlay (Hidden by default) -->
    <div id="audio-live-overlay">
        <div class="audio-wave">
            <div class="audio-bar"></div><div class="audio-bar"></div>
            <div class="audio-bar"></div><div class="audio-bar"></div>
            <div class="audio-bar"></div>
        </div>
        <h2 style="margin-top:20px;">Listening...</h2>
        <p>Release to send</p>
    </div>

    <!-- CRITICAL: Scripts -->
    <script type="module" src="chat.js"></script>
    <script type="module" src="/reminder/googleAuth.js"></script>

</body>

<style>
    /* --- HYBRID BUTTON STYLES --- */
    #send-mic-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        background: #333; /* Default Dark */
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
        user-select: none; 
        -webkit-user-select: none;
        -webkit-tap-highlight-color: transparent;
        margin-left: 10px;
        border-color: #a855f7; /* Purple focus ring */
    }

    #send-mic-btn:active {
        transform: scale(0.95);
    }

    /* State when holding (Recording) */
    #send-mic-btn.recording {
        background-color: #8515efff; /* Purple Active State */
        box-shadow: 0 0 15px #8515efff;
        transform: scale(1.2);
    }

    /* --- LIVE AUDIO OVERLAY STYLES --- */
    #audio-live-overlay {
        position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(10px);
        z-index: 9999;
        display: none; /* Hidden by default, toggled by JS */
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        font-family: sans-serif;
    }

    .audio-wave {
        display: flex; gap: 5px; height: 60px; align-items: center;
    }

    .audio-bar {
        width: 8px; background: #8515efff;
        border-radius: 4px;
        animation: wave 1s ease-in-out infinite;
    }

    @keyframes wave {
        0%, 100% { height: 10px; opacity: 0.5; }
        50% { height: 60px; opacity: 1; }
    }

    /* Staggered animation for wave effect */
    .audio-bar:nth-child(1) { animation-duration: 0.8s; }
    .audio-bar:nth-child(2) { animation-duration: 1.1s; }
    .audio-bar:nth-child(3) { animation-duration: 0.9s; }
    .audio-bar:nth-child(4) { animation-duration: 1.2s; }
    .audio-bar:nth-child(5) { animation-duration: 1.0s; }
</style>
</html>